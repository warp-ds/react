import{j as u,q as x}from"./index-DSOYRR-y.js";import{r as b}from"./index-RYns6xqu.js";import{r as S}from"./index.m-CtIADANO.js";import{a as X}from"./i18n-BJez-btc.js";import{T as M}from"./component-DwXPycX6.js";import{g as Y,u as Z}from"./help-text-BWbwCBp4.js";import{i as P}from"./index-C6dB-k_R.js";const O=JSON.parse('{"combobox.aria.pluralResults":[["numResults","plural",{"one":["#"," resultat"],"other":["#"," resultater"]}]],"combobox.aria.noResults":["Ingen resultater"]}'),ee=JSON.parse('{"combobox.aria.pluralResults":[["numResults","plural",{"one":["#"," result"],"other":["#"," results"]}]],"combobox.aria.noResults":["No results"]}'),se=JSON.parse('{"combobox.aria.pluralResults":[["numResults","plural",{"one":["#"," tulos"],"other":["#"," tulosta"]}]],"combobox.aria.noResults":["Ei tuloksia"]}'),te=JSON.parse('{"combobox.aria.pluralResults":[["numResults","plural",{"one":["#"," resultat"],"other":["#"," resultater"]}]],"combobox.aria.noResults":["Ingen resultater"]}'),le=JSON.parse('{"combobox.aria.pluralResults":[["numResults","plural",{"one":["#"," resultat"],"other":["#"," resultat"]}]],"combobox.aria.noResults":["Inga resultat"]}');function ae(r,l){return r.map(a=>({...a,id:Y(),currentInputValue:l}))}function re(r,l){if(!r)return;const a=r.filter(c=>c.value.toLowerCase().includes(l.toLowerCase())),s=P._({id:"combobox.aria.pluralResults",message:"{numResults, plural, one {# result} other {# results}}",comment:"Aria text for combobox when one or more results",values:{numResults:a.length}}),n=P._({id:"combobox.aria.noResults",message:"No results.....",comment:"Aria text for combobox when no results"});return a.length?s:n}const ne="w-react-combobox-option",oe="w-react-combobox-match",ue=b.forwardRef(({id:r,...l},a)=>{const s=Z(r),n=`${s}-listbox`,c=b.useRef(null),f=b.useRef(null),R=b.useRef(null);X(ee,te,se,O,le);const[g,i]=b.useState(!1),[t,h]=b.useState(null),[m,E]=b.useState([]),{options:T,value:d,label:U,invalid:V,helpText:J,placeholder:K,openOnFocus:$,selectOnBlur:H=!0,className:q,listClassName:z,disableStaticFiltering:C=!1,matchTextSegments:A,children:j,highlightValueMatch:I,onSelect:y,onChange:k,onFocus:L,onBlur:v,optional:G,...W}=l,N=(t==null?void 0:t.value)||d,Q=e=>S(x.option,ne,(t==null?void 0:t.id)===(e==null?void 0:e.id)?x.optionSelected:x.optionUnselected);b.useEffect(()=>{E(ae(T,d).filter(e=>C?!0:e.value.toLocaleLowerCase().includes(d.toLowerCase())))},[T,C,d]),b.useEffect(()=>{C&&m.length&&m.length===1&&!m.some(e=>e.value===d)&&i(!0)},[m,d,C]);function D(e){const o=["ArrowDown","ArrowUp","PageUp","PageDown","Home","End"].includes(e.key),p=["ArrowDown","ArrowLeft","ArrowUp","ArrowRight"];if(o&&!g)return i(!0);if(o&&g)ce(e,{setNavigationOption:h,navigationOption:t,currentOptions:m});else if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;switch(e.key){case"Enter":t&&(e.preventDefault(),_(t)),i(!1);break;case"Tab":case"Delete":i(!1);break;case"Escape":g?i(!1):k(""),h(null);break;case"Backspace":k(N),h(null),i(!0);break;default:if(p.includes(e.key))break;i(!0),t?(k(t.value),h(null)):k(d);break}}b.useEffect(()=>{if(!c.current)return;const e=c.current;return e.addEventListener("keydown",D),()=>{e.removeEventListener("keydown",D)}});function _(e){y&&y(e.value),i(!1),h(null),C&&E([])}const B={id:s,value:N,label:U,optional:G,invalid:V,helpText:J,placeholder:K,role:"combobox","aria-label":l["aria-label"],"aria-labelledby":l["aria-labelledby"],"aria-autocomplete":"list","aria-expanded":g&&m.length!==0,"aria-activedescendant":g?t==null?void 0:t.id:void 0,"aria-controls":n,onChange:function(e){k(e.target.value)},onFocus:function(){$&&(L&&L(),i(!0))},onBlur:function(e){de(R,f,e,i),H&&(t||!t&&m.findIndex(o=>o.value===d)!==-1)&&y&&y((t==null?void 0:t.value)||d),h(null),v&&v(N)},ref:function(e){c.current=e,a&&(typeof a=="function"?a(e):a.current=e)},...W};return u.jsxs("div",{className:S(q,x.wrapper),onBlur:e=>ie(e,i),ref:R,children:[u.jsx("div",{ref:f,children:j?u.jsx(M,{...B,children:j}):u.jsx(M,{...B})}),u.jsx("span",{className:x.a11y,role:"status",children:re(m,d)}),u.jsx("div",{hidden:!g||!m.length,className:S(z,x.base),style:{zIndex:3},children:u.jsx("ul",{id:n,role:"listbox",className:S(x.listbox,{[oe]:A}),children:m.map(e=>{const o=e.label||e.value;let p=[];if(A&&!I){const w=o.toLowerCase().indexOf(e.currentInputValue.toLowerCase());if(w!==-1){const F=w+e.currentInputValue.length;p=u.jsxs(u.Fragment,{children:[o.substring(0,w),u.jsx("span",{"data-combobox-text-match":!0,className:x.textMatch,children:o.substring(w,F)}),o.substring(F)]})}else p=u.jsx("span",{children:o})}else I&&(p=I(o,d));return u.jsx("li",{id:e.id,role:"option","aria-selected":(t==null?void 0:t.id)===e.id,tabIndex:-1,onClick:()=>{new Promise(w=>w(h(e))).then(()=>{_(e)})},className:Q(e),children:A||I?p:o},e.id)})})})]})});function ce(r,{setNavigationOption:l,navigationOption:a,currentOptions:s}){r.preventDefault();const n=s.findIndex(R=>R.id===(a==null?void 0:a.id)),c=n+1,f=n-1;switch(r.key){case"ArrowDown":l(c>s.length?null:s[c]);break;case"ArrowUp":l(f===-2?s[s.length-1]:f<0?null:s[f]);break;case"PageUp":l(n-10<0?s[0]:s[n-10]);break;case"PageDown":l(n+10>s.length?s[s.length-1]:s[n+10]);break;case"Home":l(s[0]);break;case"End":l(s[s.length-1]);break}}function ie(r,l){!r.currentTarget.contains(r.relatedTarget)&&l(!1)}function de(r,l,a,s){var c,f;if(!r.current)return;(!((c=r.current)!=null&&c.contains(a.relatedTarget))||((f=l.current)==null?void 0:f.contains(a.relatedTarget)))&&s(!1)}ue.__docgenInfo={description:"",methods:[],displayName:"Combobox"};export{ue as C};
